\chapter{绪论}
近年来,随着传统手机逐渐被智能手机取代，搭载了智能操作系统（如ios,Android,Windows Phone）的智能手机已经成为人们日常生活中集通信,娱乐游戏，商务办公，感知计算等于一体的移动个人终端平台。随着传感器工艺界的发展以及内置手机传感器种类的增加，如今智能手机已经能够基于传感器为用户提供良好的用户体验与服务，因此智能手机被科技赋予了更多的责任，智能手机不仅仅是简单的日常通讯工具，还是能够在记录用户的日常活动轨迹，了解用户的使用习惯，为用户提供实时信息推荐，俨然已经成为了一种新型的可穿戴计算\upcite{starner1996human}的载体,随着传统社交方式逐渐转变为手机上的社交方式，借助现有的数据分析和数据挖掘技术，通过分析手机丰富的上下文信息（Context）来研究用户社交关系以及人与人之间的社会关系已经成为移动计算中一个研究热点。

\section{研究背景}

近年来,随着传统手机逐渐被智能手机取代，搭载了智能操作系统（如ios,Android,Windows Phone）的智能手机已经成为人们日常生活中集通信，娱乐游戏，商务办公，感知计算等于一体的移动个人终端平台。通过丰富的内置传感器，我们可以收集到更加丰富的上下文信息（context）　分析出人与人之间的交互情况以及相似性\upcite{cheng2012inferring,eagle2006reality,min2013mining,pentland2009inferring}，以及通过用户轨迹数据分析用户的社交动态\upcite{zhang2011emergence}.关系强度在本文中表现为用户在现实生活中的亲密程度，通过掌握用户之间的关系强度有利于合理的拓展社交网络和提升社交质量。文献\cite{eagle2006reality}通过对手机传感器数据分析得出不同社会关系群组的用户在日常社交活动中的规律。CenceMe\upcite{miluzzo2007cenceme}通过收集智能手机传感器的上下文信息以及用户的社交应用(如Facebook，MySpace 和即时通讯工具Skype)的使用信息，分析用户的位置、活动、情绪和周围环境并将所有信息通过社交应用来分析用户的社会交互情况但是并未根据社交情况去推测用户之间的社交关系等。Dartmouth 大学学者们的研究中\upcite{wang2014studentlife,wang2015smartgpa}，通过对班级48 名学生长达10 周所采集的手机传感器数据进行研究从中分析出学生之间的社交活动有助于减轻个人压力、保护精神健康和提升学业成绩的作用，研究人与人之间的社交活动和关系强度也因此具有重要的研究意义。美国社会学家格兰洛维特在研究过程中\upcite{granovetter1973strength}首次提出了关系强度这一概念，研究将关系强度分为强关系和弱关系。同时指明能够充当信息传递载体的纽带关系必定是弱关系，而强关系只是存在于那些你真正充分信任的人之间；强关系存在与和你更加相似的用户之间。Caroline\upcite{haythornthwaite2002strong}等进一步证实了用户交互的频率以及交互的持久度决定了用户之间的关系强度，如具有较高亲密度和交互频率用户之间的关系强度要高于偶然交互和非持久交互的用户。文献\cite{gustafson2012extracting,khadangi2013measuring,zhao2012relationship}基于在线社交网络(Facebook、Twitter、LinkedIn、Instagram 等) 利用社交数据、个人资料、状态互动等分析用户之间的亲密度，结合机器学习方法采用决策树算法、MLP 算法、SVM 算法等进行用户之间关系强度的预测以及分类。以上提及的研究大都是基于用户社交数据进行的关系强度计算研究，而基于智能手机收集的非社交的传感器数据进行人与人之间关系强度的度量仍是一个值得研究的问题。
	随着各种定位技术（如全球定位系统GPS和WLAN 和移动网络）的发展和内嵌的定位模块，通过智能手机可以准确的获取用户的位置信息，提供各种基于位置的服务（LBS），并将用户的活动以轨迹的形式记录下来。我们阅读了大量社会心理学相关的论文书籍，从中证实得到在现实生活中关系亲密的两个用户会更加倾向于一起进行面对面的交流、共同进行社交活动等，因此通过对手机传感器数据的处理分析能够从中挖掘出人们现实生活中的关系强度。文献\cite{zillmann2013selective}立足于空间距离，提出了在空间距离上非常接近的人们在现实生活中就越可能发生面对面的交互，该文献通过调研一个小区的住户发现人们在现实生活中越是接近，就越容易成为朋友。文献\cite{zajonc1968attitudinal,zillmann2000mood}进一步通过研究用户的轨迹数据发现由于在空间距离中接近的用户在现实生活中更可能产生交互行为，也就是说拥有相似日常生活轨迹的用户更可能产生交互活动。郑宇\upcite{zheng2011recommending} 以及其他学者\upcite{lee2007trajectory,li2008mining,lu2011mining}尝试了基于用户轨迹计算用户相似性的研究，得出相似轨迹的用户更可能成为朋友，因此，针对相似用户进行朋友关系推荐。基于以上的理论基础和研究经验本文通过收集智能手机获取到的用户位置、WiFi、 蓝牙、通话记录等手机上下文数据，并且从这些数据中分析计算出现实生活中用户的交互位置、交互时间、交互频率以及交互的持续性等一系列能够反射出用户间关系强度的信息特征。


\section{研究现状}
\subsection{社会关系强度的研究现状}
社会关系强度理论从Mark Granovetter对弱关系的研究\upcite{granovetter1973strength}开始，Burt在弱关系理论的基础上提出了结构洞理论\upcite{burt2009structural}。Granovetter等\upcite{granovetter1973strength}认为弱关系和强关系的测量应该考虑四个维度，即两个用户之间的互动频率、用户感情的投入程度、两个用户之间的关系亲密程度以及两个用户在互惠互利上的交换程度；Wegner 等\upcite{carruthers2007illusion}指标化了这四个维度，从而可以使用数值来度量强关系和弱关系；Muncer等\upcite{burrows2000virtual}认为关系的数量和交往的频率对关系强度有重要的影响；Paolillo等\upcite{coles1999monoclonal}发现亲密程度和语言交流中非正式称呼出现的次数有直接关系。随着众多学者对关系强度的研究不断深入，逐渐形成了从互动频率、联系次数和亲密程度这三方面作为关系强度核心测量指标的主流研究观点\upcite{petroczi2007measuring}。

\subsection{基于移动数据的社会关系研究现状}
Eagle等\upcite{pentland2009inferring}招募了100名志愿者，记录他们手机上的蓝牙信息，以此为基础，通过分析志愿者之间的相遇次数来研究志愿者之间是同事关系或朋友关系。Miluzzo等\upcite{miluzzo2007cenceme} 使用诺基亚智能手机N95开发了一款名为Cenceme的应用，该应用能够实时采集手机中传感器产生的数据，通过对采集的传感器数据的分析，研究用户所处的状态以及任意两个用户之间的关系。Mtibaa等\upcite{mtibaa2008you}收集了28个参加同一个计算机会议的参会者的蓝牙数据，并利用对这些数据的分析结果构建了社会网络关系图。Crandall等\upcite{crandall2008feedback}尝试利用不同用户同时在相同地理位置的出现次数来推断社交链接。他们研究发现即使两个用户在同一地理位置的同时出现次数比较少，这两个用户也有很大可能相互认识。

\subsection{基于移动轨迹数据关系强度的研究现状}
物理层次的交互，比如面对面的交流更有可能反映社会关系的真实状态。但是到目前为止，这方面研究还比较少，文献\cite{ma2014effective}首次使用移动轨迹数据来度量用户之间的关系强度。文献\cite{ma2014effective}提出了一个层级熵关系度量方法HERMA(Hierarchical Entropy-based Relationship Measurement Approach)。HERMA利用对从轨迹中抽取的位置共现记录的分析来推断用户之间的物理交互，进而使用用户之间的物理交互来度量用户之间的社会关系强度。HERMA设计了一个层级区域结构来对用户的位置共现记录建模。并在此基础上，HERMA进一步提出用户熵和区域熵分别来度量用户的活跃性和区域开放性。最后在仿真数据集上对该方法进行了实验验证。

\section{研究内容}
本课题针对如何通过轨迹数据度量用户之间的关系强度问题展开研究，力求设计一个能够同时处理基站数据和GPS数据的通用框架模型。希望能从多个角度利用轨迹数据来度量用户之间的关系强度，经过调研和研究，决定从轨迹空间距离和基于主题模型的行为模式相似度两方面来度量用户之间的关系强度。课题中，为了达到所期望的目标，从以下三个方面展开研究。
\par (1)如何对GPS数据进行处理以及标记语义标签
\par GPS原始数据存在较大误差，且用户日常活动存在大量路上的点，而实际只需要考虑用户停留在宿舍、实验室等语义位置相关的点，故需要对GPS 数据进行降噪并剔除路上的点。在此基础上，需要通过一些方法发现与GPS 原始数据对应的如宿舍、实验室等语义位置，进而对每个语义位置标记对应的语义标签。在本课题中，通过对各种滤波算法进行试验，发现分段卡尔曼滤波有非常好的降噪效果；通过对GPS数据的进一步分析，发现路上点的密度远小于用户处于语义位置时的点的密度，因此采用基于密度的异常点剔除方法，且该方法可以自动学习参数；当前该领域用来发现语义位置的聚类算法存在一些问题，比如需要预先知道类别的个数或者对参数比较敏感，本科题决定采用最新提出的一个基于密度的聚类算法\upcite{rodriguez2014clustering}来发现语义位置，该方法对参数更鲁棒，且不需要预先知道类别个数；在得到语义位置的基础上，需要通过一些方法匹配语义位置对应的语义标签，目前通用的方法是人工手动标注，经过分析发现可以通过反地理编码，语义标签推断以及输入自动补全来减少用户和语义标签标注系统的交互。

\par (2)如何使用轨迹数据来度量用户之间的关系强度
\par a)基于轨迹空间距离的关系强度度量方法
\par 用户轨迹的相似程度在一定程度上反映了两个用户之间的亲密程度，本文尝试使用基于轨迹空间距离的方法来度量用户之间的关系强度。以往的研究中较多学者使用欧氏距离，编辑距离，DTW等方法来研究轨迹之间的相似度。但是，存在的一个问题是，欧氏距离只能用来度量两个长度相等的轨迹序列的相似度，通过实验发现使用编辑距离计算得到的相似度效果不是很理想，而DTW更偏向于序列长度较长的序列。在此基础上，对DTW的相似度度量结果使用三种方法归一化。并且发现用户每天活动的多样性不同使得该天轨迹数据的相似度对最终的相似度贡献不同，因此，使用用户每天轨迹序列的熵值对用户每天的相似度加权，实验证明该方法确实能够得到一个更好的结果。
\par b)基于主题模型的行为模式相似度度量方法
\par 通过分析研究发现，用户语义位置、语义标签均可以视为自然语言处理中的单词，而用户每天的语义位置序列和语义标签序列均可以视为自然语言处理中的句子，进而每个用户全部的语义位置序列和语义标签序列均可视为自然语言处理中的文档。因此可以从语义位置和语义标签这两个层次使用自然语言处理中一些度量文档相似度的方法来度量用户在不同层次行为模式的相似度。本课题使用LDA主题模型和word2vec模型分别来度量用户行为模式的相似度。并分析了不同的主题个数和不同的向量长度对实验结果的影响。
\par c)如何对三层实验结果进行融合
\par 前文分别研究了如何通过轨迹空间距离的方法度量用户之间的关系强度，如何通过基于语义位置的用户行为模式相似度度量用户之间的关系强度，以及如何通过基于语义标签的用户行为模式相似度度量用户之间的关系强度。在三层实验结果的基础上，如何对三层实验结果进行融合是一个很重要的问题。轨迹空间距离计算结果为两个用户轨迹的距离，距离越小说明两个用户关系强度越强，而基于行为模式的方法计算用户行为模式的相似度，相似度越大说明两个用户关系强度越强，因此不能通过简单的加权求和作为最终的关系强度，且因为数据量太少，无法通过训练来确定加权的权值。参考集成学习的思想，首先对三层方法的计算结果按关系强度进行排序，然后对和该用户关系第k 强的朋友进行投票，若某个朋友出现两次及以上则认为该朋友与该用户关系第k强，否则取基于轨迹空间距离的方法度量的结果作为最终结果。通过实验证明，该投票方法进一步改善了该模型的效果。
\par 本课题针对如何度量日常生活中人们之间的关系强度问题展开研究，提出了一个既可以对GPS数据进行处理又可以对基站数据进行处理，从日常轨迹、语义位置以及语义标签三个层次度量人们之间关系强度的层级模型URSHV(User Relationship Strength Hierarchy Vote) 。该模型首先采用DTW模型通过计算用户之间的空间距离来度量用户轨迹之间的相似度，进而使用轨迹序列熵值对用户每天轨迹的相似度进行加权处理，并将其作为用户之间的关系强度；其次，采用主题模型LDA分别计算用户之间的基于语义位置和语义标签的行为模式的相似性，将其作为用户之间的关系强度；最后，采用集成学习的思想对三个层次的度量结果进行投票，以投票结果作为最终的用户之间的关系强度。用户和陌生人之间的关系强度因为互相不认识应该为0，即用户和朋友之间的关系强度应该大于用户和陌生人之间的关系强度。但是对用户来说，虽然一些陌生人不认识，但是经常在一些地方同时出现，因此使用轨迹不能完全反映用户和所有人的关系强度，只考虑用户和其好友之间的关系强度。
\par (3)如何对实验结果进行评估以及不同参数对模型的影响
\par 本课题实验结果为用户的全部朋友按计算得到的关系强度由强到弱组成的朋友序列，实际结果是用户的全部朋友按实际关系强度由强到弱组成的朋友序列，如何度量两个包含相同元素的有序序列的一致性是本课题很重要的一个问题。本课题设计的模型中包含大量的参数，而这些参数究竟对模型有什么样的影响也是本课题很重要的一个问题。所以，在本课题中，首先基于有序序列逆序对的概念提出一种称为一致性评分的度量方法来度量两个包含相同元素的有序序列的一致性；在此基础上，通过实验观察并分析本课题设计的模型中包含的每一个参数对一致性评分的影响来研究不同参数对模型的影响。

\section{论文结构}
本文的论文结构由六章组成，各章内容概述如下：
\par 第一章为绪论，主要描述了课题的研究背景引出本文主要研究动因，然后从社会关系强度、基于移动数据的社会关系、基于移动轨迹数据关系强度的研究现状进行了分别描述，在此基础上，提出了课题的三个主要研究内容，最后给出了论文的组织结构。
\par 第二章的主要内容为相关技术研究，描述了三方面与课题工作密切相关的技术。首先从滤波算法和聚类算法两方面描述了轨迹数据预处理的主要技术，并对其进行分析；其次分析了时间序列相似度能够在一定程度上反映用户之间的关系强度，并描述了时间序列相似度度量方法中的两种主流算法，编辑距离和DTW，以及序列熵值的计算方法；最后分析了自然语言处理方法对轨迹数据处理的有效性以及主题模型和用户行为模式之间的关系，并描述了两种常用的自然语言处理模型，LDA主题模型和word2vec神经语言模型。
\par 第三章描述了用户关系强度层级投票模型的整体框架图，主要包括SASLL系统，该系统包括对GPS数据的处理以及语义标签标注技术；用户关系强度计算方法。这两个模块将在第四章和第五章分别进行描述。
\par 第四章主要描述了如何处理GPS数据以及语义标签标注技术。首先描述了SASLL（System Annotating Semantic Label of Location）系统框架；其次从降低数据噪声、剔除异常点、聚类得到语义位置三个方面描述了如何计算得到对应的语义位置；最后描述了如何发现新位置以及如何计算新位置的语义标签提示。
\par 第五章描述了用户关系强度的计算方法。首先描述了模型框架；其次分别描述了轨迹数据的处理与准备、语义位置数据的处理与准备以及语义标签数据的处理与准备三种方法；最后分别描述了基于轨迹数据的关系强度计算、基于主题模型的关系强度计算以及结果投票三个方法。
\par 第六章首先描述了实验用到的数据集；其次描述了对实验结果的评估方法；最后展示了实验结果并进行分析。
\par 第七章对本课题作出总结，并对接下来的工作作出展望。
